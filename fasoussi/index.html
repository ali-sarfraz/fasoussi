<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Valentine</title>
<style>
* { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; margin:0; padding:0; }

body {
  margin: 0;
  height: 100vh;
  height: 100dvh;
  width: 100vw;
  background: linear-gradient(135deg, #ff9a9e, #fad0c4);
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  touch-action: manipulation;
  -webkit-overflow-scrolling: touch;
  position: relative;
}

.card {
  position: relative;
  z-index: 10;
  background: rgba(255,255,255,0.97);
  padding: 30px 40px;
  border-radius: 24px;
  width: 90%;
  max-width: 500px;
  text-align: center;
  box-shadow: 0 20px 40px rgba(0,0,0,0.25);
  animation: popIn 0.8s ease;
}

#page1 { overflow: visible; }

#page2 {
  max-height: 85vh;
  max-height: 85dvh;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

#page2::-webkit-scrollbar { width: 4px; }
#page2::-webkit-scrollbar-thumb { background: #ff4d6d; border-radius: 4px; }

.hidden { display: none; }

h1 { margin-top: 0; font-size: clamp(20px, 5vw, 32px); }

h2 { margin-top: 20px; margin-bottom: 10px; font-size: clamp(18px, 4vw, 26px); color: #ff4d6d; }

#dialogMessage { margin-top: 10px; min-height: 24px; font-size: clamp(14px, 4vw, 18px); color: #ff4d6d; }

.buttons { display: flex; gap: 20px; margin-top: 20px; align-items: center; justify-content: center; }

button {
  flex: 1;
  padding: 14px;
  border-radius: 14px;
  border: none;
  font-size: clamp(16px, 4vw, 20px);
  cursor: pointer;
  transition: transform 0.3s ease;
  -webkit-tap-highlight-color: transparent;
  -webkit-appearance: none;
}

#yesBtn { background: #ff4d6d; color: white; white-space: nowrap; }
#noBtn { background: #ddd; }

#splash button {
  background: #ff4d6d;
  color: white;
  padding: 16px 40px;
  margin-top: 20px;
  font-size: clamp(18px, 4vw, 22px);
  flex: none;
}

.heart {
  position: absolute;
  animation: fall linear infinite;
  pointer-events: none;
  will-change: transform;
}

.floating-gif {
  position: absolute;
  pointer-events: none;
  will-change: transform;
  animation: floatUp linear forwards;
}

@keyframes fall {
  from { transform: translateY(0); }
  to { transform: translateY(110vh); }
}

@keyframes floatUp {
  0% { transform: translateY(0) rotate(0deg); opacity: 1; }
  80% { opacity: 0.8; }
  100% { transform: translateY(-110vh) rotate(25deg); opacity: 0; }
}

.compliment {
  position: absolute;
  background: white;
  padding: 8px 12px;
  border-radius: 16px;
  font-size: 14px;
  opacity: 0;
  animation: bubble 5s ease forwards;
  pointer-events: none;
}

@keyframes bubble {
  0% { opacity:0; transform:translateY(10px); }
  20% { opacity:1; }
  80% { opacity:1; }
  100% { opacity:0; transform:translateY(-20px); }
}

.plan {
  margin: 8px 0;
  cursor: pointer;
  padding: 8px;
  border-radius: 10px;
  background: #ffe4e9;
  transition: transform 0.2s ease;
}
.plan:active { transform: scale(0.97); }

@keyframes popIn {
  from { transform: scale(0.7); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.flip { animation: flip 1s ease forwards; }
@keyframes flip {
  from { transform: rotateY(0deg); }
  to { transform: rotateY(360deg); }
}
</style>
</head>
<body>

<audio id="bgMusic" loop preload="auto">
  <source src="music.mp3" type="audio/mpeg">
</audio>

<div class="card" id="splash">
  <h1>Esteemed Ms Fasoussi <br> You have an urgent message!</h1>
  <button onclick="openValentine()">Tap to open</button>
</div>

<div class="card hidden" id="page1">
  <h1 id="typedText"></h1>
  <div id="dialogMessage"></div>
  <div class="buttons">
    <button id="yesBtn">Yes</button>
    <button id="noBtn">No</button>
  </div>
</div>

<div class="card hidden" id="page2">
  <h1>You said YES?? <br> Ya hek ya balashhh!</h1>

  <h2>Friday Itinerary</h2>
  <div class="plan" onclick="this.innerText='Your chariot will arrive by 6 PM.'">Time</div>
  <div class="plan" onclick="this.innerText='Comfy and agile attire. Something you wouldn\'t mind getting stains on.'">Attire</div>
  <div class="plan" onclick="this.innerText='Messy and mobile. Bring a change of socks for sure.'">Vibes</div>

  <h2>Saturday Itinerary</h2>
  <div class="plan" onclick="this.innerText='Your chariot will arrive by 8:30 PM.'">Time</div>
  <div class="plan" onclick="this.innerText='Elegant and mesmerizing. Something to make all 4 of your cheeks p0p.'">Attire</div>
  <div class="plan" onclick="this.innerText='You are HER and we are THEM.'">Vibes</div>

  <button style="margin-top:15px" onclick="showMemory()">Click for one reason I love you</button>
  <p id="memory"></p>

  <p style="margin-top:20px"><em>Thank you for choosing me habibti. I will continue to choose you every day!</em></p>

  <div id="responseSection" style="margin-top:20px;">
    <h2>Say something back?</h2>
    <textarea id="responseBox" rows="4" maxlength="700"
      placeholder="Type your response here..."
      style="width:100%; padding:12px; border-radius:12px; border:2px solid #ffc0cb; font-size:16px; font-family:inherit; resize:none; outline:none; transition:border-color 0.3s;"
      onfocus="this.style.borderColor='#ff4d6d'" onblur="this.style.borderColor='#ffc0cb'"
    ></textarea>
    <div id="wordCount" style="text-align:right; font-size:13px; color:#999; margin-top:4px;">0 / 100 words</div>
    <button id="sendBtn" style="margin-top:10px; background:#ff4d6d; color:white; flex:none;" onclick="fakeSubmit()">Send</button>
    <p id="sentConfirm" class="hidden" style="margin-top:12px; color:#ff4d6d; font-weight:bold;"></p>
  </div>
</div>

<script>
var splash = document.getElementById("splash");
var typedText = document.getElementById("typedText");
var dialogMessage = document.getElementById("dialogMessage");
var yesBtn = document.getElementById("yesBtn");
var noBtn = document.getElementById("noBtn");
var page1 = document.getElementById("page1");
var page2 = document.getElementById("page2");
var bgMusic = document.getElementById("bgMusic");

var question = "على إيقاع نبض قلبي، أجرؤ أن أسألكِ... will you be my valentine? ";
var charIndex = 0;
var yesScale = 1, noScale = 1;
var saidYes = false;
var started = false;
var gifIntervalId = null;
var heartColor = "#50C878";

bgMusic.volume = 0.5;

var yesTexts = ["Yes","YES","Okay fine YES","I was always going to say yes",
"This is getting suspiciously easy","You already know the answer","For you, a thousand times over"];
var yesTextIndex = 0;

var confirmations = ["Try again","That option seems unavailable...","System error: No not supported",
"Invalid response"];

var compliments = ["You're my favorite human","This was divine design","I adore you",
"You make everything better","My heart already knows","You feel like home","I smile every time I see you",
"You're my calm and my chaos","You make ordinary days special","You're my best decision",
"You're the highlight of my day","You make me feel lucky","Your so sexy aha",
"You're effortlessly amazing","You're my comfort","You're my happy place","You make my world brighter",
"You're my favorite notification","You're the best part of my day","You make love feel easy",
"You feel like destiny","You're everything I hoped for","You make my heart feel full","You're worth choosing every time",
"I'd pick you in every lifetime","You make me feel seen"];

var memories = ["The way you laugh at our brain-rot jokes", "Your so sexy aha",
"The comfort of your presence","Every moment together is a treasure",
"The way you look at me when you're happy","How time disappears with you",
"Your voice is auditory ecstasy","How natural everything feels","Your random thoughtful moments",
"How you make me feel understood","The way you show you care","The way you make me feel chosen",
"How you brighten my worst days","How easy it is to be myself with you","How you make me laugh without trying",
"The feeling of coming back to you","The warmth you bring into my life","The way you surprise me",
"How you make love feel safe","The joy of choosing you"];
var memoryIndex = 0;

/* ---- Splash -> start everything ---- */
window.openValentine = function(){
  if(started) return;
  started = true;
  bgMusic.play().catch(function(){});
  splash.classList.add("hidden");
  page1.classList.remove("hidden");

  /* start typing */
  var typingInterval = setInterval(function(){
    if(charIndex < question.length){
      typedText.textContent += question.charAt(charIndex++);
    } else {
      clearInterval(typingInterval);
    }
  }, 80);

  /* start compliments */
  setTimeout(showCompliment, 1000);

  /* start floating gifs after 15s */
  setTimeout(function(){
    if(saidYes) return;
    gifIntervalId = setInterval(function(){
      if(saidYes){ clearInterval(gifIntervalId); gifIntervalId = null; return; }
      var gif = document.createElement("img");
      gif.src = "side.gif";
      gif.className = "floating-gif";
      var size = 24 + Math.random() * 18;
      gif.style.width = size + "px";
      gif.style.height = "auto";
      var card = document.querySelector(".card:not(.hidden)");
      var rect = card.getBoundingClientRect();
      var x;
      do { x = Math.random() * (window.innerWidth - size); } while(x > rect.left - 40 && x < rect.right + 40);
      gif.style.left = x + "px";
      gif.style.top = window.innerHeight + "px";
      var duration = 5 + Math.random() * 4;
      gif.style.animationDuration = duration + "s";
      document.body.appendChild(gif);
      setTimeout(function(){ gif.remove(); }, duration * 1000 + 500);
    }, 600);
  }, 15000);
};

/* ---- No button ---- */
noBtn.onclick = function(){
  noScale *= 0.78;
  yesScale *= 1.18;
  noBtn.style.transform = "scale(" + noScale + ")";
  yesBtn.style.transform = "scale(" + yesScale + ")";
  if(noScale < 0.12) noBtn.style.visibility = "hidden";
  if(yesTextIndex < yesTexts.length - 1) yesTextIndex++;
  yesBtn.textContent = yesTexts[yesTextIndex];
  dialogMessage.textContent = confirmations[Math.floor(Math.random() * confirmations.length)];
};

/* ---- Yes button ---- */
yesBtn.onclick = function(){
  saidYes = true;
  heartColor = "#cc0033";
  if(gifIntervalId){ clearInterval(gifIntervalId); gifIntervalId = null; }
  var floatingGifs = document.querySelectorAll(".floating-gif");
  for(var i = 0; i < floatingGifs.length; i++) floatingGifs[i].remove();

  page1.classList.add("hidden");
  page2.classList.remove("hidden");
  page2.classList.add("flip");
};

/* ---- Hearts ---- */
setInterval(function(){
  if(!started) return;
  var heart = document.createElement("div");
  heart.className = "heart";
  heart.textContent = "\u2665";
  heart.style.color = heartColor;
  var card = document.querySelector(".card:not(.hidden)");
  if(!card) return;
  var rect = card.getBoundingClientRect();
  var x;
  var safeWidth = window.innerWidth;
  do { x = Math.random() * safeWidth; } while(x > rect.left - 40 && x < rect.right + 40);
  var top = Math.random() * (window.innerHeight * 0.8);
  heart.style.left = x + "px";
  heart.style.top = top + "px";
  heart.style.fontSize = (14 + Math.random() * 20) + "px";
  heart.style.animationDuration = (4 + Math.random() * 4) + "s";
  document.body.appendChild(heart);
  setTimeout(function(){ heart.remove(); }, 9000);
}, 300);

/* ---- Compliments ---- */
function showCompliment(){
  var c = document.createElement("div");
  c.className = "compliment";
  c.textContent = compliments[Math.floor(Math.random() * compliments.length)];
  var side = Math.random() < 0.5 ? "left" : "right";
  c.style.left = side === "left" ? "10px" : "auto";
  c.style.right = side === "right" ? "10px" : "auto";
  c.style.top = Math.random() * (window.innerHeight * 0.8) + "px";
  document.body.appendChild(c);
  setTimeout(function(){ c.remove(); }, 5000);
  setTimeout(showCompliment, 1000);
}

/* ---- Memory ---- */
window.showMemory = function(){
  document.getElementById("memory").textContent = memories[memoryIndex];
  memoryIndex = (memoryIndex + 1) % memories.length;
};

/* ---- Response box ---- */
var responseBox = document.getElementById("responseBox");
var wordCount = document.getElementById("wordCount");
var sentConfirm = document.getElementById("sentConfirm");

responseBox.addEventListener("input", function(){
  var words = responseBox.value.trim().split(/\s+/).filter(function(w){ return w.length > 0; });
  var count = words.length;
  if(count > 100){
    words = words.slice(0, 100);
    responseBox.value = words.join(" ");
    count = 100;
  }
  wordCount.textContent = count + " / 100 words";
  wordCount.style.color = count >= 90 ? "#ff4d6d" : "#999";
});

window.fakeSubmit = function(){
  var msg = responseBox.value.trim();
  if(!msg) return;
  document.getElementById("sendBtn").textContent = "Sending...";
  setTimeout(function(){
    responseBox.classList.add("hidden");
    wordCount.style.display = "none";
    document.getElementById("sendBtn").classList.add("hidden");
    sentConfirm.classList.remove("hidden");
    sentConfirm.textContent = "I'm just playin albi...this website can't do that lmao. I can't wait to see you!";
  }, 2500);
};
</script>
</body>
</html>
